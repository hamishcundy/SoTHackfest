<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>SubXero</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <script src="js/vendor/modernizr-2.6.2.min.js"></script>
        <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.2/moment.min.js"></script>
        <script type="text/javascript" id="loading">
        invoices = [];
        $.getJSON('http://hamishcundy.no-ip.biz:9090/Invoices', function(data) {
            console.log(data);
             for (var i = 0; i < data.Response.Invoices.Invoice.length; i++) {
                if(data.Response.Invoices.Invoice[i].Type == 'ACCREC'){
                    invoices.push(data.Response.Invoices.Invoice[i]);
                    console.log('added ' + data.Response.Invoices.Invoice[i]);
                }
             }
             invoices.sort(function(a,b){ return a.Contact.Name) < b.Contact.Name});
             
             for(var j = 0; j < invoices.length; j++){
                var date1 = moment(invoices[j].DueDate);
                var amt = invoices[j].Total;
                var tickstring;
                var name = invoices[j].Contact.Name
                
                if($(window).width() > 700) {
                    // the width of browser is more then 800px
                } else {
                    if(name.length > 12){
                    name = name.substring(0, 11);
                    name = name + '..';
                    }
                }
                if(invoices[j].Status == 'PAID'){
                    tickstring = '<div class="tick"><img src="img/tick.svg" width="20px" height="20px" /></div>';
                }else{
                    tickstring = '<div class="tick"><img src="img/untick.svg" width="20px" height="20px" /></div>';
                }
                $("#invoices").append( '<div class="invoice">'+
                '<div class="item">' + name +
               ' </div>' +
                tickstring+
               '<div class="dateamountstring">$' +  amt+ '</div>' +
           ' <div class="dateduestring">' + date1.format('DD-MM-YYYY') + '</div>' +
  
            '</div>');
                console.log(invoices[j].Contact.Name);

             }
             $( ".invoice" ).click(function() {
            $("#dialoguebox").css({ display: 'block' });
            $("#closebox").css({ display: 'block' });
            });

            $( "#closebox" ).click(function() {
            $("#dialoguebox").css({ display: 'none' });
            $("#closebox").css({ display: 'none' });
            });
        });
        </script>

        <link rel="stylesheet" type="text/css" href="webfontkit/MyFontsWebfontsKit.css">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
        <div id="canvas">

        <div id="dialoguebox">

        </div>

        <div id="dialogue">

        <div id="closebox">
            X
        </div>

        <div id="name" class="infostyles">
            Item: <span class="stylesoverride">Red Chair</span>
        </div>

        <div id="price" class="infostyles">
            Price: <span class="stylesoverride">$40.00</span>
        </div>

        <div id="dateissued" class="infostyles">
            Issued: <span class="stylesoverride">04.10.2014</span>
        </div>

        <div id="datepaid" class="infostyles">
            Paid: <span class="stylesoverride">Unpaid</span>
        </div>

        <div id="payee" class="infostyles">
            Payee: <span class="stylesoverride">James Avon</span>
        </div>

        </div>




        <div id="header">
            <div class="titleleft">
                Welcome back!
            </div>
            <div class="titleright">
                Cashflow $0.00
            </div>
        </div>

            <div id="graph">
                <div id="graphstyles">
                    <img src="img/graph.png" width="auto" height="100%" />
                </div>  

            </div>

        <div id="invoicesheader">
            <div class="titleleft">
                Invoices
            </div>
            <div class="dateamounttitle">Amount</div>
            <div class="dateduetitle">Due</div>
        </div>

        <div id="invoices">

<!--             <div class="invoice">
                <div class="item">
                    Items
               </div>
               <div class="dateduestring">Due</div>
           <div class="dateamountstring">Amount</div>
            </div> -->

            <div class="spinner">
            </div>

        

        </div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>

        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-XXXXX-X');ga('send','pageview');
        </script>
    </body>
</html>
